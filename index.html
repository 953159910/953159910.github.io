
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>æé¸¡ä¸“å®¶</title>
    <style>
        body { text-align: center; padding: 50px 20px; font-family: Arial, sans-serif; margin: 0; position: relative; min-height: 100vh; }
        .title { font-size: 48px; color: #333; margin-bottom: 30px; }
        .counter { font-size: 60px; font-weight: bold; color: #e74c3c; margin: 20px 0; }
        .main-btn { 
            padding: 15px 40px; 
            font-size: 24px; 
            background: #3498db; 
            color: white; 
            border: none; 
            border-radius: 8px; 
            cursor: pointer; 
            margin-bottom: 40px;
        }
        .main-btn:hover { background: #2980b9; }
        .func-btns { display: flex; gap: 20px; justify-content: center; flex-wrap: wrap; margin-top: 20px; }
        .func-btn {
            padding: 12px 25px;
            font-size: 18px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            background: #2ecc71;
            color: white;
            display: flex;
            flex-direction: column;
            gap: 8px;
            min-width: 180px;
        }
        .func-btn:disabled { background: #bdc3c7; cursor: not-allowed; }
        .func-desc { font-size: 14px; opacity: 0.9; line-height: 1.2; }
        .modal {
            position: fixed; 
            top: 0; left: 0; 
            width: 100%; height: 100%; 
            background: rgba(0,0,0,0.7); 
            display: none; 
            justify-content: center; 
            align-items: center; 
            z-index: 100;
        }
        .modal-content {
            background: white; 
            padding: 40px; 
            border-radius: 10px; 
            font-size: 32px; 
            color: #2c3e50;
        }

        .rank-btn, .code-btn {
            position: fixed;
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            background: #f39c12;
            color: white;
            font-size: 16px;
            z-index: 20;
        }
        .rank-btn { bottom: 20px; right: 20px; }
        .code-btn { bottom: 20px; left: 20px; background: #9b59b6; }
        .sub-menu {
            position: fixed;
            width: 250px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
            padding: 20px;
            display: none;
            z-index: 30;
        }
        .rank-menu { bottom: 60px; right: 20px; }
        .code-menu { bottom: 60px; left: 20px; }
        .rank-list { list-style: none; padding: 0; margin: 0; }
        .rank-item {
            padding: 8px 0;
            font-size: 18px;
            display: flex;
            align-items: center;
            gap: 10px;
            border-bottom: 1px solid #eee;
        }
        .rank-item:last-child { border-bottom: none; }
        .code-form { display: flex; flex-direction: column; gap: 15px; margin-top: 10px; }
        .code-input { padding: 8px 12px; font-size: 16px; border: 1px solid #ddd; border-radius: 4px; }
        .code-submit {
            padding: 8px 0;
            background: #9b59b6;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
        }
        .code-tip { font-size: 14px; color: #e74c3c; margin: 0; height: 18px; }
        .used-codes { margin-top: 10px; font-size: 14px; color: #666; }
    </style>
</head>
<body>
    <h1 class="title">æé¸¡ä¸“å®¶ğŸ”</h1>
    <div class="counter" id="counter">0</div>
    <button class="main-btn" id="clickBtn">æä¸€æ¬¡é¸¡ğŸ”</button>

    <div class="func-btns">
        <button class="func-btn" id="multiBtn">
            æ¯æ¬¡å¤šæä¸€ä¸‹
            <span class="func-desc">ä»·æ ¼ï¼š10æ¬¡ | å½“å‰ç­‰çº§ï¼š1çº§ï¼ˆ+1/æ¬¡ï¼‰</span>
        </button>
        <button class="func-btn" id="autoBtn">
            è‡ªåŠ¨ç‚¹å‡»
            <span class="func-desc">ä»·æ ¼ï¼š50æ¬¡ | å½“å‰ç­‰çº§ï¼š1çº§ï¼ˆ1æ¬¡/ç§’ï¼‰</span>
        </button>
        <button class="func-btn" id="doubleBtn">
            é™æ—¶30ç§’2å€æ•°
            <span class="func-desc">ç”Ÿæ•ˆï¼š0ç§’ | å†·å´ï¼š0ç§’</span>
        </button>
    </div>

    <div class="modal" id="easterEgg">
        <div class="modal-content">æˆ‘å»ï¼Œæäº†è¿™ä¹ˆå¤šä¸‹ï¼Œå¤ªç‰›äº†ï¼ğŸ‘ğŸ‘ğŸ‘</div>
    </div>

    <button class="rank-btn" id="rankBtn">æ’è¡Œæ¦œğŸ¥‡</button>
    <div class="sub-menu rank-menu" id="rankMenu">
        <h3>æé¸¡å¤§å¸ˆæ¦œ</h3>
        <ul class="rank-list">
            <li class="rank-item">ğŸ¥‡ å¤é¾™é£ - 9999æ¬¡</li>
            <li class="rank-item">ğŸ¥ˆ å•†å»ºè¡Œ - 8888æ¬¡</li>
            <li class="rank-item">ğŸ¥‰ åˆ˜æ˜è½© - 7777æ¬¡</li>
            <li class="rank-item">ğŸ… ä¸œåŒ—é›¨å§ - 6666æ¬¡</li>
        </ul>
    </div>

    <button class="code-btn" id="codeBtn">å…‘æ¢ç ğŸ</button>
    <div class="sub-menu code-menu" id="codeMenu">
        <h3>è¾“å…¥å…‘æ¢ç </h3>
        <!-- ç§»é™¤maxlength="1"ï¼Œæ”¯æŒå¤šå­—è¾“å…¥ -->
        <form class="code-form" id="codeForm">
            <input type="text" class="code-input" id="codeInput" placeholder="è¾“å…¥å…‘æ¢ç ">
            <button type="submit" class="code-submit">å…‘æ¢</button>
        </form>
        <p class="code-tip" id="codeTip"></p>
        <div class="used-codes">å·²ä½¿ç”¨å…‘æ¢å­—ï¼š<span id="usedCodes">æ— </span></div>
    </div>

    <script>
        let count = 0;
        let multiLevel = 1;
        const multiBase = 10;
        const multiCoeff = 1.5;
        let autoLevel = 1;
        const autoBase = 50;
        const autoCoeff = 1.6;
        let isDouble = false;
        let doubleCd = 0;
        let doubleRemain = 0;
        const validCodes = ['åˆ˜','å¤','ç‹','å•†','å§','å“¥']; // æœ‰æ•ˆå…‘æ¢å­—
        const rewardNums = [13,78,91]; // éšæœºå¥–åŠ±æ•°å€¼
        const usedCodes = []; // å·²ä½¿ç”¨çš„æœ‰æ•ˆå…‘æ¢å­—

        const counterEl = document.getElementById('counter');
        const clickBtn = document.getElementById('clickBtn');
        const modal = document.getElementById('easterEgg');
        const multiBtn = document.getElementById('multiBtn');
        const autoBtn = document.getElementById('autoBtn');
        const doubleBtn = document.getElementById('doubleBtn');
        const rankBtn = document.getElementById('rankBtn');
        const rankMenu = document.getElementById('rankMenu');
        const codeBtn = document.getElementById('codeBtn');
        const codeMenu = document.getElementById('codeMenu');
        const codeForm = document.getElementById('codeForm');
        const codeInput = document.getElementById('codeInput');
        const codeTip = document.getElementById('codeTip');
        const usedCodesEl = document.getElementById('usedCodes');

        const eggNums = [13, 78, 91, 2778];

        function calcPrice(base, coeff, level) {
            return Math.ceil(base * Math.pow(coeff, level - 1));
        }

        function addCount(num) {
            count += num * (isDouble ? 2 : 1);
            counterEl.textContent = count;
            checkEasterEgg();
            updateBtnStates();
        }

        function checkEasterEgg() {
            if (eggNums.includes(count)) {
                modal.style.display = 'flex';
                setTimeout(() => modal.style.display = 'none', 3000);
            }
        }

        function updateBtnStates() {
            const multiPrice = calcPrice(multiBase, multiCoeff, multiLevel);
            const autoPrice = calcPrice(autoBase, autoCoeff, autoLevel);

            multiBtn.disabled = count < multiPrice;
            multiBtn.querySelector('.func-desc').textContent = 
                `ä»·æ ¼ï¼š${multiPrice}æ¬¡ | å½“å‰ç­‰çº§ï¼š${multiLevel}çº§ï¼ˆ+${multiLevel}/æ¬¡ï¼‰`;
            
            autoBtn.disabled = count < autoPrice;
            autoBtn.querySelector('.func-desc').textContent = 
                `ä»·æ ¼ï¼š${autoPrice}æ¬¡ | å½“å‰ç­‰çº§ï¼š${autoLevel}çº§ï¼ˆ${autoLevel}æ¬¡/ç§’ï¼‰`;
            
            doubleBtn.disabled = doubleCd > 0;
            doubleBtn.querySelector('.func-desc').textContent = 
                `ç”Ÿæ•ˆï¼š${doubleRemain}ç§’ | å†·å´ï¼š${doubleCd > 0 ? doubleCd + 'ç§’' : '0ç§’'}`;
        }

        setInterval(() => {
            if (doubleCd > 0) doubleCd--;
            if (doubleRemain > 0) {
                doubleRemain--;
                if (doubleRemain === 0) isDouble = false;
            }
            updateBtnStates();
        }, 1000);

        rankBtn.addEventListener('click', () => {
            rankMenu.style.display = rankMenu.style.display === 'block' ? 'none' : 'block';
            document.addEventListener('click', (e) => {
                if (!rankBtn.contains(e.target) && !rankMenu.contains(e.target)) {
                    rankMenu.style.display = 'none';
                }
            });
        });

        codeBtn.addEventListener('click', () => {
            codeMenu.style.display = codeMenu.style.display === 'block' ? 'none' : 'block';
            document.addEventListener('click', (e) => {
                if (!codeBtn.contains(e.target) && !codeMenu.contains(e.target)) {
                    codeMenu.style.display = 'none';
                }
            });
        });

        // å…‘æ¢ç æ ¸å¿ƒé€»è¾‘æ›´æ–°ï¼šæ”¯æŒå¤šå­—è¾“å…¥ï¼Œå«æœ‰æ•ˆå­—å³å¯å…‘æ¢ï¼ˆæ¯ä¸ªæœ‰æ•ˆå­—ä»…ç”¨ä¸€æ¬¡ï¼‰
        codeForm.addEventListener('submit', (e) => {
            e.preventDefault();
            const inputCode = codeInput.value.trim();
            
            // ç©ºè¾“å…¥éªŒè¯
            if (!inputCode) {
                codeTip.textContent = 'è¯·è¾“å…¥å…‘æ¢ç ï¼';
                return;
            }

            // ç­›é€‰è¾“å…¥ä¸­åŒ…å«çš„æœ‰æ•ˆä¸”æœªä½¿ç”¨çš„å­—
            const validUnusedChars = inputCode.split('').filter(char => 
                validCodes.includes(char) && !usedCodes.includes(char)
            );

            // æ— æœ‰æ•ˆæ–°å­—åˆ™æç¤ºæ— æ•ˆ
            if (validUnusedChars.length === 0) {
                codeTip.textContent = 'å…‘æ¢ç æ— æ•ˆæˆ–æ— æ–°å¥–åŠ±ï¼';
                return;
            }

            // å…‘æ¢æˆåŠŸï¼šæ¯ä¸ªæœ‰æ•ˆæ–°å­—éšæœºå¥–åŠ±ä¸€æ¬¡ï¼Œå»é‡é¿å…é‡å¤æ·»åŠ å·²ç”¨å­—
            let totalReward = 0;
            validUnusedChars.forEach(char => {
                if (!usedCodes.includes(char)) {
                    const reward = rewardNums[Math.floor(Math.random() * rewardNums.length)];
                    totalReward += reward;
                    usedCodes.push(char); // æ ‡è®°ä¸ºå·²ä½¿ç”¨
                }
            });

            // å‘æ”¾æ€»å¥–åŠ±å¹¶æ›´æ–°æ˜¾ç¤º
            addCount(totalReward);
            usedCodesEl.textContent = usedCodes.join('ã€') || 'æ— ';
            codeTip.textContent = `å…‘æ¢æˆåŠŸï¼è·å¾—${totalReward}æ¬¡ğŸ‰`;
            codeInput.value = ''; // æ¸…ç©ºè¾“å…¥æ¡†
        });

        clickBtn.addEventListener('click', () => addCount(multiLevel));

        multiBtn.addEventListener('click', () => {
            const multiPrice = calcPrice(multiBase, multiCoeff, multiLevel);
            if (count >= multiPrice) {
                count -= multiPrice;
                multiLevel++;
                addCount(0);
            }
        });

        autoBtn.addEventListener('click', () => {
            const autoPrice = calcPrice(autoBase, autoCoeff, autoLevel);
            if (count >= autoPrice) {
                count -= autoPrice;
                autoLevel++;
                clearInterval(window.autoInterval);
                window.autoInterval = setInterval(() => addCount(autoLevel), 1000 / autoLevel);
                addCount(0);
            }
        });

        doubleBtn.addEventListener('click', () => {
            isDouble = true;
            doubleRemain = 30;
            doubleCd = 60;
            updateBtnStates();
        });

        updateBtnStates();
    </script>
</body>
</html>
